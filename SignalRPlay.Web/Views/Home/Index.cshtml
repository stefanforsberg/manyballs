@model object

@{
    Layout = null;
}

<!DOCTYPE html>

<html >
<head runat="server">
    <script src="../../Scripts/jquery-1.7.1.min.js" type="text/javascript"></script>
    <script src="../../Scripts/jquery.cookie.js" type="text/javascript"></script>
    <script src="../../Scripts/jquery.signalR.min.js" type="text/javascript"></script>
    <script src="/signalr/hubs" type="text/javascript"></script>
    
    <style type="text/css">
        #game-area {
            width: 800px;
            display: none;    
        }
        
        #myDrawing {
            border: solid 3px #e2e2e2;
            float: left;
            margin-right: 30px;
        }
        
        #users {
            float: left;
        }
        
        ul {
            list-style: none;
            padding: 0px;
            margin: 0px;
        }
    </style>

    <script type="text/javascript">
        $(function () {
            var game = $.connection.game;

            $.connection.hub.start(function () {

            });

            game.draw = function (data) {

                // Check the element is in the DOM and the browser supports canvas
                var drawingCanvas = document.getElementById('myDrawing');
                // Initaliase a 2-dimensional drawing context
                var context = drawingCanvas.getContext('2d');

                context.clearRect(0, 0, 500, 500);

                console.log(data[0].Value.LocX);

                for (var i = 0; i < data.length; i++) {
                    var ball = data[i].Value;

                    context.fillStyle = "#" + ball.Color;

                    context.beginPath();
                    context.arc(ball.LocX, ball.LocY, 40, 0, Math.PI * 2, true);
                    context.closePath();

                    context.fill();
                }

            };

            game.showUsers = function (data) {
                for (var i = 0; i < data.length; i++) {
                    var ball = data[i].Value;

                    $("#users ul").append('<li><span style="padding-right: 15px; margin-right: 5px; width: 15px; background-color: #' + ball.Color + '"></span> ' + ball.Name + '</li>');
                }
            };

            $("#join").click(function () {
                
                game.join($("#name").val(), $("#color").val());
                $("#game-area").show();
            });

            $("html").keydown(function (event) {
                if (event.which == "37") {
                    game.moveBall('l');
                }

                if (event.which == "38") {
                    game.moveBall('u');
                }

                if (event.which == "39") {
                    game.moveBall('r');
                }

                if (event.which == "40") {
                    game.moveBall('d');
                }
            });

        });
    </script>

</head>
    <body>
        Namn:
        <input type="text" id="name" />
        &nbsp;&nbsp;&nbsp;
        Färg
        # <input type="text" id="color" />
        <input type="button" id="join" value="Bolla! "/>

        <div id="game-area">
        <canvas id="myDrawing" width="500" height="500" ></canvas>
        
        <div id="users">
            <ul>
                
            </ul>
        </div>
        </div>
    </body>
</html>